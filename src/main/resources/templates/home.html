<html>
<head>
    <title>Monkey notes</title>

</head>
<body>

<div>
    <a href="/preferences">Preferences</a>
    <a href="/processing">Processes</a>
</div>

<div>
    <span th:text="${error}"></span>
</div>

<div th:if= "${authUrl != ''}"><a th:href="${authUrl}">authenticate</a></div>
<div th:if= "${authUrl == ''}">

    <div>
        <a href="/update/all">Update All</a>
    </div>
    <h2>File and Folder Structure</h2>

    <ul>
        <li th:each="fileNode : ${fileNodes}">
            <span th:if="${fileNode.folder}"><a th:href="@{/folder/pdf/{id}(id=${fileNode.dtoFile.fileId})}"><span th:text="${fileNode.name}"></span></a></span>
            <ul th:if="${fileNode.folder}">
                <a th:href="@{/update/folder/{folderId}(folderId=${fileNode.dtoFile.fileId})}">Refresh</a>
                <li th:replace="~{::subTree(${fileNode.children})}">
                </li>
            </ul>
        </li>
    </ul>

    <th:block th:fragment="subTree(children)">
        <li th:each="file : ${children}">
            <span th:text="${file.name}"></span>
            <span th:if="${not file.folder}">
                <span th:if="${file.dtoTranscript}">(<span th:text="${file.dtoTranscript.pageCount}"></span> pages)</span>
                <a th:href="@{/transcript/{id}(id=${file.dtoFile.fileId})}">view</a> -
                <a th:href="@{/transcript/pdf/{id}(id=${file.dtoFile.fileId})}">get pdf</a>
            </span>
            <ul th:if="${file.folder}">
                <li th:replace="~{::subTree(${file.children})}"></li>
            </ul>
        </li>
    </th:block>
</div>


</body>
</html>